---
alwaysApply: true
---

# AI への指示書

## 役割とコンテキスト

### 役割

これから私が行う様々なプログラミングに関する要望や質問に対して、アシスタントとして的確なサポートを提供してください。

### プロジェクトコンテキスト

一つのファイルは 100 行以内で書くようにしてください。

## ワークフロー

### Plan → Act → Reflect

1. **Plan**: 実装前に計画提示 → ユーザー承認待ち（承認の際は「GO」サイン）
2. **Act**: 承認後、型ヒント付きで最小限の変更
3. **Reflect**: 変更内容と理由を簡潔に説明

## 基本的なルール

- **コードの品質**: 常にクリーンで、効率的、そして可読性の高いコードを生成してください。
- **コードのリファクタリング**: 既存のコードをリファクタリングする際は、ロジックを機能単位で適切な関数に分割し、可読性と保守性を高めることを意識してください。
- **import 文**: import 文は、要求された機能を実現するために必要かつ一般的なものだけを使用してください。既存のコードを扱う際は、import 文を勝手に変更・削除しないでください。
- **ダミーのコード**: 動作しない、あるいは仮置きの関数や変数は含めないでください。
- **コメント**: コードだけで意図が明確に伝わる場合、コメントは不要です。複雑なアルゴリズムや、特定のライブラリの少し特殊な使い方など、補足が必要な場合にのみ簡潔なコメントを記述してください。
- **説明**: コードを提示する際は、そのコードが何をしているのか、なぜそのように実装したのかについての要点を簡潔に添えてください。
- **修正範囲**: ユーザーからの修正依頼があった部分以外は、原則として変更しないでください。
- **プロンプトの修正**: この指示書（プロンプト）自体の修正を依頼された場合は、修正後のプロンプト全体を Markdown 形式のコードブロックで出力してください。

## コーディング規約

### 言語とスタイル

- 日本語を用いること
- step by step で思考すること

### 命名規則

- 同一ファイル内でしか使用しない関数には `_` を先頭に付けて命名すること

### 設計原則

- 単一責任原則を適用し、機能を追加する場合は単一責任原則に基づいてコードを分割すること
- それぞれのファイルは最大 100 行程度に収めることを目指すこと（import 文の長さは考慮しない）
- `shared/`などの共通ファイルからの再利用を検討すること

#### YAGNI - 必要になるまで実装しない

- 現時点で必要な機能のみ実装すること
- 「将来使うかも」という理由で拡張機能を追加しないこと
- 必要になった時点で追加する方が要件が明確になる

#### KISS - シンプルに保つ

- 最もシンプルな解決策を選ぶこと
- 複雑なパターンより単純な関数を優先すること
- 1 行で済むなら複雑なループは不要

#### DRY - 賢く適用

- 明確な重複パターンがある場合のみ共通化すること
- 2 箇所なら重複を許容し、3 箇所目で共通化を検討すること
- 似ているだけの異なるロジックを無理に共通化しないこと
- 早すぎる抽象化より、重複を許容してシンプルさを保つことを優先すること

#### OAOO - Once and Only Once

- 同じロジックは一箇所にのみ実装すること
- 重複したロジックを見つけたら、共通化を検討すること
- KISS と YAGNI の原則と矛盾しない範囲で適用すること
- 共通化により複雑さが増す場合は、シンプルさを優先すること

### 型とコード品質

- **関数定義時には引数と返り値の型ヒントを必ず付けること**
- 非推奨のロジックは使わないこと（例：`while True`など）
- リントエラーを解消すること。修正後は、プロジェクトで設定されているリントツールを実行してエラーがないことを確認すること
- 修正を行う場合は可能な限り最小限の修正で済ませること
- ドックストリングは1行にすること。複雑な関数の場合は、要約して１行にすること。

### 品質チェックリスト

実装前に以下を確認すること：

#### YAGNI

- [ ] この機能は**今**必要か？
- [ ] ユーザーが明示的に要求したか？

#### KISS

- [ ] もっとシンプルな方法はないか？
- [ ] 他の開発者が 5 分で理解できるか？

#### OAOO

- [ ] 同じロジックが複数箇所に存在しないか？
- [ ] 共通化できる箇所がないか？

#### 過剰設計の兆候（避ける）

- ❌ 1 箇所でしか使われていない共通関数
- ❌ 使われていない抽象クラス
- ❌ 誰も使わないオプションパラメータ
